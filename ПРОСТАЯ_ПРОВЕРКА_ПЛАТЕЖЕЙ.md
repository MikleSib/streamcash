# üöÄ –ü—Ä–æ—Å—Ç–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –£–±—Ä–∞–ª–∏ —Å–ª–æ–∂–Ω—ã–π Celery, —Å–¥–µ–ª–∞–ª–∏ –ø—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç!

**–ë–´–õ–û:** Celery Worker + Celery Beat (—Å–ª–æ–∂–Ω–æ, –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ)
**–°–¢–ê–õ–û:** –û–¥–∏–Ω –ø—Ä–æ—Å—Ç–æ–π Python —Å–∫—Ä–∏–ø—Ç –≤ —Ü–∏–∫–ª–µ ‚ö°

## üîß –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –°–æ–∑–¥–∞–Ω –ø—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç: `backend/payment_checker.py`
- üîÑ –†–∞–±–æ—Ç–∞–µ—Ç –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
- üîç –ò—â–µ—Ç –≤—Å–µ PENDING –ø–ª–∞—Ç–µ–∂–∏ T-Bank –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö  
- üí≥ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ T-Bank API GetState
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç CONFIRMED ‚Üí COMPLETED
- ‚ùå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç CANCELLED ‚Üí FAILED
- üìä –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å—Ç—Ä–∏–º–µ—Ä–∞
- üîî –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- üìù –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### Docker Compose –æ–±–Ω–æ–≤–ª–µ–Ω
–ó–∞–º–µ–Ω–∏–ª–∏ 2 —Å–ª–æ–∂–Ω—ã—Ö Celery —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ 1 –ø—Ä–æ—Å—Ç–æ–π:
```yaml
# –†–∞–Ω—å—à–µ:
- celery-worker    # —Å–ª–æ–∂–Ω–æ
- celery-beat      # —Å–ª–æ–∂–Ω–æ

# –°–µ–π—á–∞—Å: 
- payment-checker  # –ø—Ä–æ—Å—Ç–æ!
```

## üöÄ –ó–∞–ø—É—Å–∫

### SSL —Ä–µ–∂–∏–º (–ø—Ä–æ–¥–∞–∫—à–Ω):
```bash
docker-compose -f docker-compose.ssl.yml down
docker-compose -f docker-compose.ssl.yml up -d
```

### –û–±—ã—á–Ω—ã–π —Ä–µ–∂–∏–º (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞):
```bash
docker-compose down  
docker-compose up -d
```

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –õ–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π:
```bash
# –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏ —Å–∫—Ä–∏–ø—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
docker-compose -f docker-compose.ssl.yml logs -f payment-checker
```

**–î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:**
```
üöÄ –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π T-Bank
‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ T-Bank –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã  
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ
üîÑ –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ü–∏–∫–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥...

üìä –ù–∞–π–¥–µ–Ω–æ 2 PENDING –ø–ª–∞—Ç–µ–∂–µ–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º donation ID: 62, payment_id: 6769622675
üí≥ –ü–æ–ª—É—á–µ–Ω —Å—Ç–∞—Ç—É—Å: CONFIRMED –¥–ª—è donation 62
‚úÖ –û–±–Ω–æ–≤–ª—è–µ–º donation 62 –Ω–∞ COMPLETED
üìä –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç—Ä–∏–º–µ—Ä–∞ 1: +1.0 —Ä—É–±
üîî –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–ª—è donation 62
‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –û–±–Ω–æ–≤–ª–µ–Ω–æ: 1 –∏–∑ 2
‚è±Ô∏è –¶–∏–∫–ª –≤—ã–ø–æ–ª–Ω–µ–Ω –∑–∞ 0.45 —Å–µ–∫. –°–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 10 —Å–µ–∫.
```

### –ï—Å–ª–∏ –Ω–µ—Ç PENDING –ø–ª–∞—Ç–µ–∂–µ–π:
```
üìä PENDING –ø–ª–∞—Ç–µ–∂–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
‚è±Ô∏è –¶–∏–∫–ª –≤—ã–ø–æ–ª–Ω–µ–Ω –∑–∞ 0.02 —Å–µ–∫. –°–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 10 —Å–µ–∫.
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ—Å—Ç–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞

### ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- –ù–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö –æ—á–µ—Ä–µ–¥–µ–π Redis
- –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π –∑–∞–¥–∞—á  
- –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ - –ø—Ä–æ—Å—Ç–∞—è –æ—Ç–ª–∞–¥–∫–∞

### ‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:**
- –í–∏–¥–Ω–æ –∫–∞–∂–¥—ã–π —à–∞–≥ –≤ –ª–æ–≥–∞—Ö
- –ü–æ–Ω—è—Ç–Ω–æ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–æ–≥–¥–∞
- –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã

### ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞:**
- 1 —Ñ–∞–π–ª –≤–º–µ—Å—Ç–æ 3-—Ö (celery_app.py, tasks.py, worker.py)
- 1 –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–º–µ—Å—Ç–æ 2-—Ö (worker + beat)
- –ú–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–Ω–µ –Ω—É–∂–µ–Ω Redis –¥–ª—è –∑–∞–¥–∞—á)

### ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –ù–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ Celery
- –ü—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∞–∑–µ –∏ API
- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–Ω–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Celery)

## üîç –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥

1. **–ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö**
2. **–ò—â–µ—Ç PENDING –ø–ª–∞—Ç–µ–∂–∏** —Å payment_method=TBANK
3. **–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞:**
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω –¥–ª—è T-Bank API
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç GetState –∑–∞–ø—Ä–æ—Å 
   - –ü–æ–ª—É—á–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å
   - –û–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–∑—É –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–∏–ª—Å—è
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å—Ç—Ä–∏–º–µ—Ä–∞
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
4. **–õ–æ–≥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**
5. **–ñ–¥–µ—Ç 10 —Å–µ–∫—É–Ω–¥** –∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç

## üõ†Ô∏è Troubleshooting

### –°–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker-compose -f docker-compose.ssl.yml ps payment-checker

# –°–º–æ—Ç—Ä–∏–º –æ—à–∏–±–∫–∏ –∑–∞–ø—É—Å–∫–∞
docker-compose -f docker-compose.ssl.yml logs payment-checker
```

### –ü–ª–∞—Ç–µ–∂–∏ –Ω–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è:
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Ö–æ–¥–∏—Ç PENDING –ø–ª–∞—Ç–µ–∂–∏
docker-compose -f docker-compose.ssl.yml logs payment-checker | grep "PENDING"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ T-Bank
docker-compose -f docker-compose.ssl.yml logs payment-checker | grep "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π:
```bash
docker-compose -f docker-compose.ssl.yml restart payment-checker
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–¢–µ–ø–µ—Ä—å –≤–∞—à–∏ –ø–ª–∞—Ç–µ–∂–∏ –±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –Ω–∞–¥–µ–∂–Ω–æ!**

- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –∫–æ–¥
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π  
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫
- ‚úÖ –ù–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –õ–µ–≥–∫–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å

**–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –∫–∞–∫ –æ–±—ã—á–Ω–æ - —Å–∫—Ä–∏–ø—Ç –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!** üöÄ